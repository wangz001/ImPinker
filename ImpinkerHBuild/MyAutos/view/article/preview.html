<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../../css/mui.min.css" />
		<link rel="stylesheet" href="../../css/icons-extra.css" />
		<link rel="stylesheet" href="../../css/weibo/comment.css" />
		<link rel="stylesheet" href="../../js/qqFace/css/reset.css" />
		<link rel="stylesheet" href="../../css/imageviewer.css" />
		<style type="text/css">
			html,
			body {
				margin: 0px;
				padding: 0px;
				overflow: hidden;
				-webkit-touch-callout: none;
				-webkit-user-select: none;
			}
			
			.mui-card-header.mui-card-media {
				display: block;
				padding: 0px;
			}
			
			.thread-info img {
				width: 35px;
				height: 35px;
				border-radius: 8px;
				vertical-align: middle;
				overflow: hidden;
				margin-right: 2px;
			}
			
			.thread-info {
				margin: 10px 10px 10px 0px;
			}
			
			.thread-info .username {
				font-size: 16px;
			}
			
			.mui-content-padded p img {
				width: auto;
				height: auto;
				max-width: 100%;
				max-height: 100%;
			}
			
			.mui-content {
				height: 100%;
				overflow: auto;
				padding-bottom: 50px;
			}
			
			.mui-bar-footer {
				display: flex;
				-webkit-box-pack: justify;
				-webkit-justify-content: space-between;
				-webkit-box-align: center;
				-webkit-align-items: center;
				align-items: center;
				overflow: hidden;
				padding: 0px 15px;
				width: 100%;
				min-height: 50px;
			}
			
			.mui-bar-footer .mui-btn {
				margin-bottom: 13px;
			}
			
			#composeText {
				margin-bottom: 5px;
			}
			
			.mui-bar-footer .mui-icon,
			.mui-bar-footer .mui-icon-extra {
				padding-right: 30px;
			}
			
			.zhezhaoDiv {
				position: fixed;
				z-index: 998;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				background-color: #fafafa;
			}
			
			.mui-content img {
				width: 100%;
			}
		</style>
	</head>

	<body>
		<div class="zhezhaoDiv">
			<p id="mui-progressbar" class="mui-progressbar mui-progressbar-infinite"></p>
		</div>
		<header id="header" class="mui-bar mui-bar-transparent">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 id='articlename' class="mui-title">导航栏</h1>
		</header>
		<div id="content" class="mui-content">
			<img id="coverimage" src="">
			<div class="mui-content-padded">
				<div class="mui-card-header mui-card-media thread-info">
					<img src="" id='user_headimg'>
					<div class="mui-media-body">
						<em class="mui-icon mui-icon-person username" id="user_name">bwlang</em>
						<p class="publish-time">发表于 2016-06-30 15:30</p>
					</div>
				</div>
				<div>
					<p>简介：</p>
					<p id="article_description"></p>
				</div>
				<br />
				<!-- 文章主体 -->
				<div class="" id='articlecontent'>
				</div>
				<div class="article-footer">
					<!--<img src="http://img.myautos.cn/commenfile/qrcode_for_gh_7f5be927b079_258.jpg" />-->
					<p>车酷自驾游是专注自驾游分享、交友社区，欢迎关注</p>
				</div>
				<div class="mui-clearfix"></div>
				<div class="mui-content">
					<div class="row mui-input-row">
						<textarea id='comment_text' class="mui-input-clear question" placeholder="请输入评论内容..."></textarea>
					</div>
					<div class="mui-card-content">
						<a id="icon-plus" class="emotion"><span class="mui-icon mui-icon-plus"></span></a>
						<button id="sendComposs" type="button" class="mui-btn mui-btn-primary mui-btn-outlined mui-pull-right">
					发布
					</button>
					</div>
					<div class="mui-content-padded">
						<div class="mui-inline">评论列表</div>
					</div>
					<div id='comment' style="background-color:#fff;min-height: 50px;" class="mui-card-content">
						<p>暂无评论</p>
					</div>
				</div>
			</div>
		</div>
		<br>
		<br>
		<footer id="mui-footer" class="mui-bar mui-bar-footer">
			<a class="mui-icon mui-icon-compose" style="float: inherit;"></a>
			<a id="vote" class="mui-icon mui-icon-extra mui-icon-extra-heart" style="float: inherit;"></a>
			<a id="share" class="mui-icon-extra mui-icon-extra-share"></a>
			<!--<input id="composeText" type="text" placeholder="请输入评论" style="width: 80%;display: none;margin-top: 5px;" />
			<a id="sendComposs" class="mui-btn mui-btn-primary mui-btn-outlined" style="display:none;">发送</a>-->
		</footer>
		<script src="../../js/mui.min.js"></script>
		<script type="text/javascript" src="../../js/app.js"></script>
		<script type="text/javascript" src="../../js/jquery.js"></script>
		<script type="text/javascript" src="../../js/commonUtil.js"></script>
		<script type="text/javascript" src="../../js/qqFace/js/jquery.qqFace.js"></script>
		<script type="text/javascript" src="../../js/article/article_preview.js"></script>
		<script type="text/javascript" src="../../js/mui.previewimage.js"></script>
		<script type="text/javascript" src="../../js/mui.zoom.js"></script>
		<script type="text/javascript" src="../../js/storageUtil.js"></script>
		<script type="text/template" id='comment_item'>
			<dl class="comment-list hot" commentid="@comment.Id">
				<dt>
                        <i class="headpic">
                            <img src="$HeadImage$">
                        </i>
                        <em class="userinfo">
                            $UserName$
                            <p>$CreateTime$</p>
                        </em>
                        <em class="commentvote">
                            <!--<a class="comment_like" commentid='$Id$'><span class="mui-icon-extra mui-icon-extra-heart"></span></a>-->
                            <a class="comment_to" commentid='$Id$'><span class="mui-icon mui-icon-compose"></span></a>
                        </em>
                </dt>
				<dd>
					<p>
						$Content$
					</p>
				</dd>
				$tocomment$
			</dl>

		</script>
		<script type="text/template" id="comment_item_to">
			<dl class="quote">
				<dt>
                    <i class="headpic">
                        <img src="$HeadImage$">
                    </i>
                    <em class="userinfo">
                        $UserName$
                        <p>$CreateTime$</p>
                    </em>
                </dt>
				<dd>
					<p>
						$Content$
					</p>
				</dd>
			</dl>
		</script>
		<script type="text/javascript">
			var articleItem = null;
			var shares = null,
				sharewx = null,
				shareweibo = null;
			mui.plusReady(function() {
				//获取参数
				var self = plus.webview.currentWebview();
				var articleid = self.articleid;
				var articlename = self.articlename;
				$("#title").html(articlename);
				//判断是否赞过文章
				var isVote = storageUtil.getArticleVote(articleid);
				if(isVote) {
					$('#vote').removeClass("mui-icon-extra-heart");
					$('#vote').addClass("mui-icon-extra-heart-filled");
				}
				getArticle(articleid);
				getArticleComment(articleid);
				// 扩展API加载完毕，现在可以正常调用扩展API
				plus.share.getServices(function(s) {
					shares = s;
					for(var i in s) {
						if('weixin' == s[i].id) {
							sharewx = s[i];
						}
						if('sinaweibo' == s[i].id) {
							shareweibo = s[i];
						}
					}
				}, function(e) {
					alert("获取分享服务列表失败：" + e.message);
				});
			});

			mui.previewImage();

			$(function() {
				$('.emotion').qqFace({
					assign: 'comment_text',
					path: '../../js/qqFace/arclist/' //表情存放的路径
				});
			});

			//查看结果

			function replace_em(str) {
				str = str.replace(/\</g, '&lt;');
				str = str.replace(/\>/g, '&gt;');
				str = str.replace(/\n/g, '<br/>');
				str = str.replace(/\[em_([0-9]*)\]/g, '<img src="../../js/qqFace/arclist/$1.gif" border="0" />');
				return str;
			}

			document.getElementById('share').addEventListener('tap', function() {
				var btnArray = [{
					title: '分享给微信好友'
				}, {
					title: '分享到微信朋友圈'
				}, {
					title: '分享到新浪微博'
				}];
				plus.nativeUI.actionSheet({
					title: "分享",
					cancel: '取消',
					buttons: btnArray
				}, function(e) {
					var index = e.index; // 
					switch(index) {
						case 1:
							sharewx.send({
								title: articleItem.ArticleName,
								content: articleItem.Description,
								href: "http://m.myautos.cn/Article/Index?id=" + articleItem.Id,
								thumbs: [
									articleItem.CoverImage.replace("articlecover_36_24", "articlecover_100")
								],
								extra: {
									scene: "WXSceneSession"
								}
							}, function() {
								mui.toast("分享给好友成功");
							}, function(e) {
								mui.toast("取消分享");
							});
							break;
						case 2:
							sharewx.send({
								title: articleItem.ArticleName,
								content: articleItem.Description,
								href: "http://m.myautos.cn/Article/Index?id=" + articleItem.Id,
								thumbs: [
									articleItem.CoverImage.replace("articlecover_36_24", "articlecover_100")
								],
								extra: {
									scene: "WXSceneTimeline"
								}
							}, function() {
								mui.toast("分享成功");
							}, function(e) {
								mui.toast("取消分享");
							});
							break;
						case 3:
							shareweibo.send({
								title: articleItem.ArticleName,
								content: articleItem.Description,
								href: "http://m.myautos.cn/Article/Index?id=" + articleItem.Id,
								thumbs: [
									articleItem.CoverImage.replace("articlecover_36_24", "articlecover_100")
								]
							}, function() {
								mui.toast("分享成功");
							}, function(e) {
								mui.toast("取消分享");
							});
							break;
					}
				});
			});
		</script>
	</body>

</html>