<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>article</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="css/mui.min.css">
		<style>
			html,
			body {
				background-color: #efeff4;
			}
			
			.title {
				margin: 20px 15px 10px;
				color: #6d6d72;
				font-size: 15px;
			}
		</style>
	</head>

	<body>
		<div id="pullrefresh" class="mui-content mui-scroll-wrapper">
			<div class="mui-slider">
				<div class="mui-slider-group">
					<div class="mui-slider-item">
						<!-- 具体内容 -->
						<img class="mui-media-object mui-pull-left" src="images/shuijiao.jpg">
					</div>
					<!--第二个内容区-->
					<div class="mui-slider-item">
						<img class="mui-media-object mui-pull-left" src="images/muwu.jpg">
						<!-- 具体内容 -->
					</div>
				</div>
			</div>
			<div class="mui-scroll">
				<ul class="mui-table-view">
					<li class="mui-table-view-cell mui-media">
						<a href="javascript:;">
							<img class="mui-media-object mui-pull-left" src="images/shuijiao.jpg">
							<div class="mui-media-body">
								幸福
								<p class="mui-ellipsis">能和心爱的人一起睡觉，是件幸福的事情；可是，打呼噜怎么办？</p>
							</div>
						</a>
					</li>
				</ul>
			</div>
		</div>
	</body>
	<script src="js/mui.min.js"></script>
	<script>
		mui.init({
			swipeBack: false,
			pullRefresh: {
				container: '#pullrefresh',
				down: {
					callback: pulldownRefresh
				},
				up: {
					auto: true, //可选,默认false.自动上拉加载一次
					contentrefresh: '正在加载...',
					callback: pullupRefresh
				}
			}
		});
		/**
		 * 下拉刷新具体业务实现
		 */
		function pulldownRefresh() {
			setTimeout(function() {
				var table = document.body.querySelector('.mui-table-view');
				var cells = document.body.querySelectorAll('.mui-table-view-cell');
				for(var i = cells.length, len = i + 3; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'mui-table-view-cell';
					li.innerHTML = '<a class="mui-navigate-right">Item ' + (i + 1) + '</a>';
					//下拉刷新，新纪录插到最前面；
					table.insertBefore(li, table.firstChild);
				}
				mui('#pullrefresh').pullRefresh().endPulldownToRefresh(); //refresh completed
			}, 1000);
		}
		var count = 0;
		/**
		 * 上拉加载具体业务实现
		 */
		var pageNum=1;
		function pullupRefresh() {
			//			setTimeout(function() {
			//				mui('#pullrefresh').pullRefresh().endPullupToRefresh((++count > 2)); //参数为true代表没有更多数据了。
			//				var table = document.body.querySelector('.mui-table-view');
			//				var cells = document.body.querySelectorAll('.mui-table-view-cell');
			//				for(var i = cells.length, len = i + 20; i < len; i++) {
			//					var li = document.createElement('li');
			//					li.className = 'mui-table-view-cell mui-media';
			//					li.innerHTML = '<a href="javascript:;">' +
			//						'<img class="mui-media-object mui-pull-left" src="images/cbd.jpg"><div class="mui-media-body">' +
			//						'CBD<p class="mui-ellipsis">烤炉模式的城，到黄昏，如同打翻的调色盘一般.</p></div></a>';
			//					table.appendChild(li);
			//				}
			//			}, 1000);

			mui.ajax('http://api.myautos.cn/Article/GetByPage', {
				data: {
					pageNum: pageNum,
					pageSize: 10
				},
				dataType: 'json', //服务器返回json格式数据
				type: 'get', //HTTP请求类型
				success: function(data) {
					var list=data.data;
					for(var i = 0; i < list.length; i++) {
						var item=list[i];
						var table = document.body.querySelector('.mui-table-view');
						var li = document.createElement('li');
						li.className = 'mui-table-view-cell mui-media';
						li.innerHTML = '<a href="javascript:;">' +
							'<img class="mui-media-object mui-pull-left" src="images/cbd.jpg"><div class="mui-media-body">' +
							item.ArticleName+'<p class="mui-ellipsis">'+item.Company+'</p></div></a>';
						table.appendChild(li);
					}
					pageNum++;
					mui('#pullrefresh').pullRefresh().endPullupToRefresh(); //参数为true代表没有更多数据了。
				}
			});
		}
	</script>

</html>